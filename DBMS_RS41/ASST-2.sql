CREATE DATABASE CRICKET_TOURNAMENT;
USE CRICKET_TOURNAMENT;

create table SUPPLIER(
SID VARCHAR(10) primary key,
SNAME VARCHAR(15), 
CITY VARCHAR(10));

CREATE table ITEM(
ITEM_ID VARCHAR(10) PRIMARY KEY, 
INAME VARCHAR(15), 
COLOR VARCHAR(10), 
WEIGHT INT);

CREATE TABLE SUPPLY(
SID VARCHAR(10),
foreign key(SID) references SUPPLIER(SID), 
ITEM_ID VARCHAR(10),
foreign key(ITEM_ID) references ITEM(ITEM_ID), 
QUANTITY INT); 



insert INTO SUPPLIER values 
('S001','MANISH','KOLKATA'),
('S002','HARI','DELHI'),
('S003','KUNDAN','KOLKATA'),
('S004','SAGAR','PATNA'),
('S005','ZAHIR','DELHI');

select * FROM SUPPLIER;


INSERT INTO ITEM values
('ITEM 1','DESK','BROWN',20),
('ITEM 2','CHAIR','RED',7),
('ITEM 3','BOARD-1','BLUE',15),
('ITEM 4','BOARD-2','WHITE',10),
('ITEM 5','MARKER','BLACK',20);

select * FROM ITEM;


INSERT into SUPPLY values
('S002','ITEM 2', 210),
('S001','ITEM 5',200),
('S005','ITEM 1',125),
('S002','ITEM 5',500),
('S005','ITEM 2',156),
('S001','ITEM 1',370); 

select * FROM SUPPLY;

/*QUERY 1 */
SELECT SID FROM SUPPLIER;

SELECT * FROM ITEM WHERE ITEM_ID IN(SELECT ITEM_ID FROM SUPPLY GROUP BY ITEM_ID HAVING count(SID)>=1);

SELECT SID FROM SUPPLIER WHERE CITY='DELHI';

SELECT SID FROM SUPPLIER WHERE CITY !='KOLKATA';

SELECT SID, SNAME FROM SUPPLIER WHERE SID NOT IN (SELECT distinct SID FROM SUPPLY );

SELECT SID, SNAME FROM SUPPLIER WHERE SID IN (SELECT SID FROM SUPPLY GROUP BY ITEM_ID having count(ITEM_ID)>=1);

SELECT SID, SNAME FROM SUPPLIER WHERE SID IN (SELECT SID FROM SUPPLY WHERE ITEM_ID='ITEM 1');

SELECT SID, SNAME FROM SUPPLIER WHERE SID IN (SELECT SID FROM SUPPLY WHERE ITEM_ID IN ('ITEM 1','ITEM 2'));

select SID, SNAME FROM SUPPLIER WHERE SID IN (SELECT SID FROM SUPPLY WHERE ITEM_ID IN (SELECT ITEM_ID FROM ITEM WHERE COLOR='RED'));


select SID, SNAME FROM SUPPLIER WHERE SID IN (SELECT SID FROM SUPPLY WHERE ITEM_ID IN (SELECT ITEM_ID FROM ITEM WHERE COLOR='RED'IN (SELECT ITEM_ID FROM SUPPLY WHERE QUANTITY between 200 AND 500)));

